(function(t){function e(e){for(var s,o,a=e[0],c=e[1],l=e[2],h=0,p=[];h<a.length;h++)o=a[h],r[o]&&p.push(r[o][0]),r[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},r={runner:0},i=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;i.push([18,"chunk-vendors"]),n()})({"0177":function(t,e,n){},"042d":function(t,e,n){},"0895":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-rendering-window"},t._l(t.chats,function(e){return n("p",{staticClass:"each-message",class:["user"===e.from?"user":"runner"]},[t._v(t._s(e.from+": "+e.message))])}))},r=[],i={props:["chats"],data(){return{}},computed:{isUser(){return"user"===this.chat.from}}},o=i,a=(n("b56a"),n("2877")),c=Object(a["a"])(o,s,r,!1,null,null,null);c.options.__file="renderChat.vue";e["a"]=c.exports},18:function(t,e,n){t.exports=n("1cf1")},"19c5":function(t,e,n){"use strict";var s=n("438a"),r=n.n(s);r.a},"1cf1":function(t,e,n){"use strict";n.r(e);var s=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},i=[],o={},a=o,c=(n("3362"),n("2877")),l=Object(c["a"])(a,r,i,!1,null,null,null);l.options.__file="app.vue";var u=l.exports,h=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.showMenu?n("runner-menu",{on:{hideMenu:t.hideMenu}}):t._e(),n("a",{staticClass:"menu__hamburger-icon",attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.renderMenu(e)}}},[t._v("☰")]),n("router-view",{attrs:{socket:t.socket}})],1)},d=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-block"},[n("menu",{staticClass:"runner-menu",on:{click:function(e){t.$emit("hideMenu")}}},[n("li",{staticClass:"close-menu"},[n("span",{on:{click:function(e){t.$emit("hideMenu")}}},[t._v("⬅")])]),n("li",{staticClass:"component-link"},[n("router-link",{attrs:{to:"/showCurrentAssignment"}},[t._v("Current Assignment")])],1),n("li",{staticClass:"component-link"},[n("router-link",{attrs:{to:"/showPastAssignments"}},[t._v("Past Assignments")])],1),n("li",{staticClass:"component-link"},[n("router-link",{attrs:{to:"/myProfile"}},[t._v("My Profile")])],1),t._m(0)])])},m=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"component-link"},[n("a",{attrs:{href:"https://dunzoclone.now.sh/runner/signout",role:"button"}},[t._v("Sign out")])])}],g={},v=g,_=(n("1e71"),Object(c["a"])(v,f,m,!1,null,null,null));_.options.__file="runnerMenu.vue";var b=_.exports,w={components:{runnerMenu:b},data(){return{lat:0,lng:0,showMenu:!1,socket:"",urlMapsAPI:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCyrqmHGMWIf_a_EmXRsFi_3KWTr2koaBU&libraries=places",urlSocketio:"https://dunzoclone.now.sh/socket.io/socket.io.js",intervalId:null,showHam:!0}},methods:{hideMenu(){this.showMenu=!1},getCoordinates(){navigator.geolocation.watchPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.socket.emit("position update",[this.lng,this.lat]),console.log(this.lat,this.lng)})},loadScript(t){let e=document.createElement("script");e.setAttribute("src",t),e.setAttribute("async",!0),e.setAttribute("defer",!0),document.head.appendChild(e)},checkForSocket(){io&&(this.socket=io("https://dunzoclone.now.sh/"),clearInterval(this.intervalId))},renderMenu(){this.showMenu=!0},async getPublicVapidKey(){let t="https://dunzoclone.now.sh/publicVapidKey",e=await(await fetch(t)).json();return e},async initiateServiceWorker(){try{let t=await navigator.serviceWorker.getRegistration();t||(t=await navigator.serviceWorker.register("runnerSW.js",{scope:"/"}));let e=await t.pushManager.getSubscription(),n=!e;return e||(e=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:await this.getPublicVapidKey()})),!!n&&e}catch(t){console.log(t)}},async subscribePushNotification(t){await fetch("https://dunzoclone.now.sh/subscribe",{mode:"cors",method:"post",body:JSON.stringify(t),headers:{"content-type":"application/json",authorization:document.cookie.split(";").map(t=>t.trim()).filter(t=>t.startsWith("access_token="))[0].substring(13)}})}},async mounted(){if(this.loadScript(this.urlMapsAPI),this.loadScript(this.urlSocketio),this.intervalId=setInterval(this.checkForSocket,3e3),this.getCoordinates(),navigator.serviceWorker){let t=await this.initiateServiceWorker();t&&this.subscribePushNotification(t)}}},y=w,k=(n("2849"),Object(c["a"])(y,p,d,!1,null,null,null));k.options.__file="runner.vue";var C=k.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"current-assignment-details"},[t.order.description?n("div",[n("p",[t._v("Description: "+t._s(t.order.description))]),n("p",[t._v("Placed-on: "+t._s(t.order.placedOn))]),n("p",[t._v("Pickup: "+t._s(t.order.fromAddr))]),n("p",[t._v("Drop: "+t._s(t.order.toAddr))]),n("button",{on:{click:t.goToChat}},[t._v("Chat with user")])]):n("p",[t._v("No Assignments")]),t.order.description?n("button",{on:{click:t.fulfillOrder}},[t._v("fulfill")]):t._e()])},j=[],M={components:{runnerMenu:b},data(){return{currentOrderUrl:"https://dunzoclone.now.sh/runner/currentOrder",fulfillOrderUrl:"https://dunzoclone.now.sh/runner/fulfillorder",order:{}}},methods:{goToChat(){this.$router.push(`${this.$route.path}/chat`)},async getCurrentAssignments(){let t=await fetch(this.currentOrderUrl,this.constructFetchBody()),e=await t.json();return e},constructFetchBody(){return{mode:"cors",headers:{authorization:document.cookie.split(";").map(t=>t.trim()).filter(t=>t.startsWith("access_token="))[0].substring(13),"content-type":"application/json"}}},async fulfillOrder(){let t=await fetch(this.fulfillOrderUrl,{...this.constructFetchBody(),method:"post",body:JSON.stringify({orderID:this.order._id})});console.log(await t.json()),this.order=await this.getCurrentAssignments()}},async mounted(){this.order=await this.getCurrentAssignments(),console.log(this.order)}},P=M,S=(n("9197"),Object(c["a"])(P,O,j,!1,null,null,null));S.options.__file="showCurrentAssignment.vue";var A=S.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"past-assignment-details"},t._l(t.orders,function(e){return n("li",{staticClass:"each-assignment"},[n("p",[t._v(t._s(e.status))]),n("p",[t._v("placed On: "+t._s(e.placedOn))]),n("p",[t._v(t._s(e.description))])])}))},x=[],U={data(){return{pastOrderUrl:"https://dunzoclone.now.sh/runner/pastOrders",orders:null}},methods:{async getPastAssignments(){let t=await fetch(this.pastOrderUrl,this.constructFetchBody()),e=await t.json();return e},constructFetchBody(){return{mode:"cors",headers:{authorization:document.cookie.split(";").map(t=>t.trim()).filter(t=>t.startsWith("access_token="))[0].substring(13)}}}},async mounted(){this.orders=await this.getPastAssignments()}},$=U,z=(n("6980"),Object(c["a"])($,I,x,!1,null,null,null));z.options.__file="showPastAssignments.vue";var E=z.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"profile"},[n("img",{staticClass:"profile__pic",attrs:{src:t.profile.profilePicture,alt:"pic"}}),n("p",[t._v("Name: "+t._s(t.profile.name))]),n("p",[t._v("EmailId: "+t._s(t.profile.emailID))]),n("p",[t._v("First Signin: "+t._s(t.profile.firstSignedIn))]),n("p",[t._v("Recent Signin: "+t._s(t.profile.recentSignedIn))]),n("p",[t._v("Number of orders: "+t._s(t.profile.pastOrders.length))])])},F=[],L={data(){return{profileUrl:"https://dunzoclone.now.sh/runner/profile",profile:{}}},methods:{async getMyProfile(){let t=await fetch(this.profileUrl,this.constructFetchBody()),e=await t.json();return console.log(e),e},constructFetchBody(){return{headers:{authorization:document.cookie.split(";").map(t=>t.trim()).filter(t=>t.startsWith("access_token="))[0].substring(13)}}}},async mounted(){this.profile=await this.getMyProfile(),console.log(this.profile)}},B=L,W=(n("221c"),Object(c["a"])(B,R,F,!1,null,null,null));W.options.__file="runnerProfile.vue";var D=W.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-component"},[t._m(0),t.fetchingURL?n("p",[t._v("loading")]):n("signin-button",{staticClass:"signin-button-block",attrs:{loginURL:t.loginURL}})],1)},K=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"heading"},[n("h1",{staticClass:"heading__h1"},[t._v("Dunzo-Clone")]),n("h2",{staticClass:"heading__runner-greeting"},[t._v("Hey, Runner")])])}],T=n("63ae"),J={components:{signinButton:T["a"]},data(){return{loginURL:null}},methods:{async getLoginURL(){try{let t=await fetch("https://dunzoclone.now.sh/runner/login"),e=(await t.json()).url;return e}catch(t){return null}}},async mounted(){this.loginURL=await this.getLoginURL()},computed:{fetchingURL(){return!this.loginURL}}},V=J,H=(n("ff98"),Object(c["a"])(V,N,K,!1,null,null,null));H.options.__file="runnerLogin.vue";var q=H.exports,G=n("9646"),X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-component"},[n("render-chat",{attrs:{chats:t.chats}}),n("div",{staticClass:"chat-input-box"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{type:"text",placeholder:"Enter your message"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}}),n("button",{attrs:{disabled:t.disabledSendBtn},on:{click:t.sendMessage}},[t._v("send")])])],1)},Q=[],Y=n("0895"),Z={props:["socket"],components:{renderChat:Y["a"]},data(){return{message:"",chats:[],orderID:null,intervalId:null}},methods:{async getCurrentAssignment(){let t=await fetch(this.currentOrderUrl,this.constructFetchBody()),e=await t.json();return e},sendMessage(){this.socket.emit("chat message",[this.orderID,this.message],t=>this.chats.push(t)),this.message=""},getPastMessages(t){this.chats=t},checkForSocket(){this.socket&&(this.socket.emit("join chat room",this.orderID),this.socket.on("past messages",this.getPastMessages),this.socket.on("chat message",t=>this.chats.push(t)),clearInterval(this.intervalId))}},computed:{disabledSendBtn(){return!(this.message.length>0)}},async mounted(){const t=await(await fetch("https://dunzoclone.now.sh/runner/currentOrder",{mode:"cors",headers:{authorization:document.cookie.split(";").map(t=>t.trim()).filter(t=>t.startsWith("access_token="))[0].substring(13)}})).json();this.orderID=t._id,this.intervalId=setInterval(this.checkForSocket,3e3)}},tt=Z,et=(n("19c5"),Object(c["a"])(tt,X,Q,!1,null,null,null));et.options.__file="runnerChat.vue";var nt=et.exports;s["a"].use(h["a"]);var st=new h["a"]({routes:[{path:"/login",component:q},{path:"/",component:C,children:[{path:"/",redirect:"/showCurrentAssignment"},{path:"/showCurrentAssignment",component:A},{path:"/showCurrentAssignment/chat",component:nt},{path:"/showPastAssignments",component:E},{path:"/myProfile",component:D},{path:"/about",component:G["a"]}]}]});e["default"]=new s["a"]({router:st,render:t=>t(u)}).$mount("#app")},"1e71":function(t,e,n){"use strict";var s=n("efca"),r=n.n(s);r.a},"221c":function(t,e,n){"use strict";var s=n("042d"),r=n.n(s);r.a},2849:function(t,e,n){"use strict";var s=n("be03"),r=n.n(s);r.a},3362:function(t,e,n){"use strict";var s=n("89c9"),r=n.n(s);r.a},"438a":function(t,e,n){},5199:function(t,e,n){},"63ae":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"signin-button"},[s("a",{staticClass:"signin-button__link",attrs:{href:t.loginURL}},[s("img",{staticClass:"signin-button__g-image",attrs:{src:n("c616"),alt:"sign in with google"}})])])},r=[],i={props:["loginURL"]},o=i,a=(n("7ea8"),n("2877")),c=Object(a["a"])(o,s,r,!1,null,"471daa62",null);c.options.__file="signinButton.vue";e["a"]=c.exports},6980:function(t,e,n){"use strict";var s=n("f8b4"),r=n.n(s);r.a},"7ea8":function(t,e,n){"use strict";var s=n("ac0c"),r=n.n(s);r.a},"89c9":function(t,e,n){},9197:function(t,e,n){"use strict";var s=n("0177"),r=n.n(s);r.a},"93e7":function(t,e,n){},9410:function(t,e,n){"use strict";var s=n("93e7"),r=n.n(s);r.a},9646:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",[t._v("Developed by Karthik and Mukul")])])}],i={},o=i,a=(n("9410"),n("2877")),c=Object(a["a"])(o,s,r,!1,null,null,null);c.options.__file="about.vue";e["a"]=c.exports},ac0c:function(t,e,n){},b56a:function(t,e,n){"use strict";var s=n("5199"),r=n.n(s);r.a},be03:function(t,e,n){},c616:function(t,e,n){t.exports=n.p+"img/btn_google_signin_light_normal_web@2x.52a05e73.png"},efca:function(t,e,n){},f2e9:function(t,e,n){},f8b4:function(t,e,n){},ff98:function(t,e,n){"use strict";var s=n("f2e9"),r=n.n(s);r.a}});
//# sourceMappingURL=runner.bf7e5d2b.js.map